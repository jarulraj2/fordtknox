jdgm=window.jdgm||{},jdgm.CACHE_SERVER_HOST="https://cache.judge.me",jdgm.HTTPS_HOST="https://judge.me",jdgm.CDN_HOST="https://cdnwidget.judge.me/",window.jdgmCacheServer||(jdgmCacheServer={},function(){var cacheMetafieldsUrl=jdgm.CACHE_SERVER_HOST+"/widgets/"+jdgm.PLATFORM+"/"+jdgm.SHOP_DOMAIN,parseHTML=function(e){var t=document.createElement("div");return t.innerHTML=e,t.children},appendHTML=function(e,t){for(;t.length>0;)e.appendChild(t[0])},appendJsScript=function(e){if(jdgm.loadJS)return jdgm.loadJS(jdgm.CDN_HOST+e);var t=document.createElement("script");t.src=jdgm.CDN_HOST+e,t.id=e.replaceAll(/\W/gi,"_"),document.head.appendChild(t)},appendCssScript=function(e){if(jdgm.loadCSS)return jdgm.loadCSS(jdgm.CDN_HOST+e);var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.id=e.replaceAll(/\W/gi,"_"),t.href=jdgm.CDN_HOST+e,document.head.appendChild(t)},formatParams=function(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")},requestCacheServer=function(e,t){var a=new XMLHttpRequest;a.open("GET",cacheMetafieldsUrl+formatParams(e),!0),a.onreadystatechange=function(){if(4===a.readyState)if(a.status>=200&&a.status<400){var e=JSON.parse(a.responseText);t(e)}else console.warn("Cannot load Judge.me widget contents due to caching server error."),console.log(a)},a.onerror=function(){console.warn("Cannot load Judge.me widget contents due to caching server error."),console.log(a)},a.send()},fillContentToWidget=function(e,t,a,d){Array.prototype.forEach.call(e,function(e,r){e.querySelector(d)||(a?appendHTML(e,parseHTML(t[e.getAttribute("data-id")])):appendHTML(e,parseHTML(t)))})};jdgmCacheServer._loadAll=function(){return"undefined"!=typeof jdgmSettings?(console.warn("Widget already loaded."),!1):void loadContent(!0)};var loadContent=function(firstRequest){var previewBadges=document.querySelectorAll(".jdgm-preview-badge"),reviewWidget=document.querySelectorAll(".jdgm-review-widget"),reviewTab=document.querySelectorAll(".jdgm-revs-tab"),allReviewsPage=document.querySelectorAll(".jdgm-all-reviews-widget"),featuredCarousel=document.querySelectorAll(".jdgm-carousel-wrapper"),allReviewsRating=document.querySelectorAll(".jdgm-all-reviews-rating"),allReviewsCount=document.querySelectorAll(".jdgm-all-reviews-count"),verifiedBadge=document.querySelectorAll(".jdgm-verified-badge-wrapper, .jdgm-verified-count-badget"),medals=document.querySelectorAll(".jdgm-medals-wrapper"),ugcMediaGrid=document.querySelectorAll(".jdgm-ugc-media-wrapper"),allReviewsText=document.querySelectorAll(".jdgm-all-reviews-text"),popupWidget=document.querySelectorAll(".jdgm-popup-widget"),reviewSnippetWidget=document.querySelectorAll(".jdgm-review-snippet-widget"),data={public_token:jdgm.PUBLIC_TOKEN||""};if(previewBadges.length>0){var badgeArray=Array.from(previewBadges),previewBadgeProductIds=badgeArray.map(function(e){return e.getAttribute("data-id")}).join(",");data.preview_badge_product_ids=previewBadgeProductIds}if(reviewWidget.length>0){var widgetArray=Array.from(reviewWidget),reviewWidgetProductIds=widgetArray.map(function(e){return e.getAttribute("data-id")}).join(",");data.review_widget_product_ids=reviewWidgetProductIds}reviewTab.length>0&&(data.reviews_tab=1,data.all_reviews_rating=1,data.all_reviews_count=1),featuredCarousel.length>0&&(data.featured_carousel=1,data.all_reviews_rating=1,data.all_reviews_count=1),allReviewsPage.length>0&&(data.all_reviews_page=1),verifiedBadge.length>0&&(data.verified_badge=1),allReviewsCount.length>0&&(data.all_reviews_count=1),allReviewsRating.length>0&&(data.all_reviews_rating=1),medals.length>0&&(data.medals=1),ugcMediaGrid.length>0&&(data.ugc_media_grid=1),allReviewsText.length>0&&(data.all_reviews_text=1,data.all_reviews_rating=1,data.all_reviews_count=1),popupWidget.length>0&&(data.popup_widget=1),reviewSnippetWidget.length>0&&(data.review_snippet_widget=1),requestCacheServer(data,function(response){if(firstRequest){var settings=parseHTML(response.settings);Array.prototype.forEach.call(settings,function(e){if("jdgm-settings-script"===e.className)eval(e.text),jdgmSettings.widget_advanced_speed_features=jdgmSettings.widget_advanced_speed_features||5;else if("text/javascript"===e.type){var script=document.createElement("script");script.id=e.id,script.src=e.src,document.head.appendChild(script)}else document.head.appendChild(e.cloneNode(!0))});var htmlMiracle=parseHTML(response.html_miracle);appendHTML(document.head,htmlMiracle)}if(firstRequest){var cssPath=parseFloat(jdgmSettings.widget_version)>=3?"widget_v3/base.css":"judgeme_widget_v2.css";appendCssScript(cssPath)}if(data.preview_badge_product_ids&&fillContentToWidget(previewBadges,response.preview_badges,!0),data.review_widget_product_ids&&fillContentToWidget(reviewWidget,response.review_widgets,!0),data.reviews_tab&&fillContentToWidget(reviewTab,response.reviews_tab,!1,".jdgm-revs-tab__wrapper"),data.featured_carousel&&fillContentToWidget(featuredCarousel,response.featured_carousel,!1,".jdgm-carousel"),data.verified_badge&&fillContentToWidget(verifiedBadge,response.verified_badge,!1),data.all_reviews_page&&Array.prototype.forEach.call(allReviewsPage,function(e,t){for(var a=parseHTML(response.all_reviews),d=parseHTML(response.all_reviews_header);a.length>0;)e.querySelector(".jdgm-all-reviews__body").appendChild(a[0]);for(;d.length>0;)e.insertBefore(d[0],e.querySelector(".jdgm-all-reviews__body"))}),data.popup_widget&&fillContentToWidget(popupWidget,response.popup_widget,!1,".jdgm-popup-widget"),data.review_snippet_widget&&fillContentToWidget(reviewSnippetWidget,response.review_snippet_widget,!1,".jdgm-review-snippet-widget"),data.all_reviews_rating&&Array.prototype.forEach.call(allReviewsRating,function(e,t){e.setAttribute("data-score",response.all_reviews_rating)}),data.all_reviews_count&&Array.prototype.forEach.call(allReviewsCount,function(e,t){e.innerHTML=response.all_reviews_count}),data.medals&&fillContentToWidget(medals,response.medals,!1,".jdgm-medals"),data.ugc_media_grid&&fillContentToWidget(ugcMediaGrid,response.ugc_media_grid,!1),data.all_reviews_text){var allReviewsTextHtml=["<a href='javascript:void(0)'>","<span class='jdgm-all-reviews-rating' data-score='"+response.all_reviews_rating+"'></span>","<span class='jdgm-all-reviews-text__text' data-score='"+response.all_reviews_rating+"' data-number-of-reviews='"+response.all_reviews_count+"'></span>","</a>"].join("");Array.prototype.forEach.call(allReviewsText,function(e,t){e.insertAdjacentHTML("afterbegin",allReviewsTextHtml)})}if(firstRequest){var jsPath=parseFloat(jdgmSettings.widget_version)>=3?"loader.js":"judgeme_widget_v2.js";appendJsScript(jsPath)}})};jdgmCacheServer.reloadPreviewBadges=function(){var e=document.querySelectorAll(".jdgm-preview-badge:not(.jdgm--done-setup)"),t={public_token:jdgm.PUBLIC_TOKEN};if(e.length>0){var a=Array.from(e),d=a.map(function(e){return e.getAttribute("data-id")}).join(",");t.preview_badge_product_ids=d}requestCacheServer(t,function(a){t.preview_badge_product_ids&&fillContentToWidget(e,a.preview_badges,!0),"function"==typeof jdgm.customizeBadges?jdgm.customizeBadges():console.log("Core JS are not loaded yet.")})};var clearAll=function(){var e=[".jdgm-settings-style",".jdgm-miracle-styles",".jdgm-random-link",".jdgm-prefetch",".jdgm-script",".jdgm-stylesheet","#judgeme_widget_v2_css","#judgeme_widget_v2_js","#widget_v3_base_css","#loader_js","#judgeme_widget_leex_css","#judgeme_widget_leex_js","#judgeme_widget_align_css","#judgeme_widget_carousel_css","#judgeme_widget_carousel_js"];e.forEach(function(e){var t=document.querySelectorAll(e);t.forEach(function(e){e.remove()})});var t=[".jdgm-preview-badge",".jdgm-review-widget",".jdgm-all-reviews-widget",".jdgm-carousel-wrapper",".jdgm-revs-tab",".jdgm-all-reviews-widget",".jdgm-verified-badge-wrapper",".jdgm-medals-wrapper",".jdgm-ugc-media-wrapper",".jdgm-all-reviews-text",".jdgm-popup-widget",".jdgm-review-snippet-widget"],a={".jdgm-carousel-wrapper":['<h2 class="jdgm-carousel-title">Featured reviews</h2>','<a href="/reviews" class="jdgm-all-reviews-rating-wrapper">','<div data-score="" class="jdgm-all-reviews-rating"></div> from <span class="jdgm-all-reviews-count"></span> reviews',"</a>"].join(""),".jdgm-revs-tab":['<div class="jdgm-revs-tab-btn btn" position="bottom">Reviews</div>','<div class="jdgm-revs-tab__header">','<a class="jdgm-close-ico"></a>','<h3 class="jdgm-revs-tab__title">Product Reviews</h3>','<a href="/pages/reviews">','<div class="jdgm-all-reviews-rating"></div>','<span class="jdgm-all-reviews-count"></span> reviews',"</a>","</div>"].join(""),".jdgm-all-reviews-widget":'<div class="jdgm-all-reviews__body"></div>'};t.forEach(function(e){var t=document.querySelectorAll(e);t.forEach(function(t){t.innerHTML=a[e]||"",t.classList.remove("jdgm--done-setup"),t.classList.remove("jdgm--done-setup-widget")})}),jdgm._doneSetup=null};jdgmCacheServer.reloadAllWidgets=function(){jdgmCacheServer.reloadAll()},jdgmCacheServer.reloadAll=function(){clearAll(),loadContent(!0)},shopbasePageLoad=function(){"shopbase"==jdgm.PLATFORM&&window.sbsdk.$on("page_load",function(){setTimeout(jdgmCacheServer.reloadAll,0)})};var documentReady=function(e){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)};documentReady(function(){return jdgm.PLATFORM&&jdgm.SHOP_DOMAIN?(jdgmCacheServer._loadAll(),void shopbasePageLoad()):(console.warn("Cannot load Judge.me widget contents due to missing jdgm key. Check value of jdgm.PLATFORM, jdgm.SHOP_DOMAIN, jdgm.PUBLIC_TOKEN respectively:",jdgm.PLATFORM,jdgm.SHOP_DOMAIN,jdgm.PUBLIC_TOKEN),!1)})}());